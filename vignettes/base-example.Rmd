---
title: "base-example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{base-example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(tidyverse)
library(janitor)
library(tsrecipes)
library(recipes)
```

```{r}
tsdb <- tsrecipes::prices
```


```{r}
prepped <- recipe(tsdb) %>%
  step_dct(ts, k = 8, preserve = TRUE) %>%
  prep()


tsdb_dct <- bake(prepped, tsdb)
tsdb_dct
```

```{r}
trained_step <- prepped$steps[[1]]

tsdb_recon <- tsdb_dct %>%
  reconstruct("ts", trained_step, starts_with("ts."))
```

```{r}
set.seed(103)
tsdb_recon %>%
  sample_n(5) %>%
  unnest(c(ts, ts_recon, n)) %>% 
  ggplot(aes(n)) +
  geom_line(aes(y = ts, group = id), color = "red") +
  geom_line(aes(y = ts_recon, group = id), color = "blue") +
  facet_wrap(~id)
```



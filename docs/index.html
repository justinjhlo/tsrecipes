<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Time series preprocessing for tidymodels • tsrecipes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Time series preprocessing for tidymodels">
<meta property="og:description" content="tsrecipes provides time series dimensionality reduction and feature
    engineering using the discrete cosine transform. It also offers time series
    clustering using the dtwclust package. All preprocessing methods
    are designed to work in the tidymodels framework.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tsrecipes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/tsrecipes.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/benchmarking-dct.html">DCT Benchmarks</a>
    </li>
    <li>
      <a href="articles/dct.html">What is the discrete cosine transform?</a>
    </li>
    <li>
      <a href="articles/dtw.html">What is dynamic time warping?</a>
    </li>
    <li>
      <a href="articles/time-series-clustering.html">Time series clustering with dynamic time warping</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tmastny/tsrecipes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="tsrecipes" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tsrecipes" class="anchor"></a>tsrecipes</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of tsrecipes is to provide time series proprocessing to accommodate time series classification and clustering in the <a href="https://www.tidymodels.org/">tidymodels</a> framework.</p>
<p>The primary steps are</p>
<ul>
<li>discrete cosine transform for dimensionality reduction and feature engineering</li>
<li>dynamic time warping clustering</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install tsrecipes with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"tmastny/tsrecipes"</span>)</pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="time-series-dimensionality-reduction" class="section level3">
<h3 class="hasAnchor">
<a href="#time-series-dimensionality-reduction" class="anchor"></a>Time series dimensionality reduction</h3>
<p>In time series classification, using the time series as a feature often results in poor accuracy because it’s the auto-correlation between entries and the overall trend that’s the most informative, rather than individual values.</p>
<p>The discrete cosine transform is one way to extract useful, uncorrelated features with significantly fewer dimensions than the time series.</p>
<p>In this example, it’s possible to classify time series of length 1751 into 4 classes with 70% accuracy, only using 16 dimensions.</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidymodels</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tsrecipes</span>)

<span class="no">rec</span> <span class="kw">&lt;-</span> <span class="fu">recipe</span>(<span class="no">ethanol</span>, <span class="kw">var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">ethanol</span>), <span class="kw">roles</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"outcome"</span>, <span class="st">"input"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/step_dct.html">step_dct</a></span>(<span class="no">ts</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fu">tune</span>())

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2532</span>)
<span class="no">tune_results</span> <span class="kw">&lt;-</span> <span class="fu">workflow</span>() <span class="kw">%&gt;%</span>
  <span class="fu">add_model</span>(<span class="fu">multinom_reg</span>() <span class="kw">%&gt;%</span> <span class="fu">set_engine</span>(<span class="st">"nnet"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">add_recipe</span>(<span class="no">rec</span>) <span class="kw">%&gt;%</span>
  <span class="fu">tune_grid</span>(
    <span class="kw">resamples</span> <span class="kw">=</span> <span class="fu">validation_split</span>(<span class="no">ethanol</span>),
    <span class="kw">grid</span> <span class="kw">=</span> <span class="fu">expand_grid</span>(<span class="kw">k</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">16</span>, <span class="fl">32</span>, <span class="fl">64</span>))
  )

<span class="no">tune_results</span> <span class="kw">%&gt;%</span>
  <span class="fu">collect_metrics</span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">.metric</span> <span class="kw">==</span> <span class="st">"accuracy"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">k</span>, <span class="no">mean</span>)
<span class="co">#&gt; # A tibble: 5 x 2</span>
<span class="co">#&gt;       k  mean</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     4 0.278</span>
<span class="co">#&gt; 2     8 0.389</span>
<span class="co">#&gt; 3    16 0.754</span>
<span class="co">#&gt; 4    32 0.746</span>
<span class="co">#&gt; 5    64 0.849</span></pre></div>
</div>
<div id="time-series-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#time-series-clustering" class="anchor"></a>Time series clustering</h3>
<p>tsrecipes also enables times series clustering using the dynamic time warping metric. <code>step_dtw</code> is powered by the <a href="https://github.com/asardaes/dtwclust">dtwclust</a> package.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">ethanol_clusters</span> <span class="kw">&lt;-</span> <span class="fu">recipe</span>(<span class="no">ethanol</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/step_dtw.html">step_dtw</a></span>(<span class="no">ts</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">4</span>) <span class="kw">%&gt;%</span>
  <span class="fu">prep</span>() <span class="kw">%&gt;%</span>
  <span class="fu">bake</span>(<span class="no">ethanol</span>)</pre></div>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">ethanol_clusters</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">1751</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">unnest</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ts</span>, <span class="no">n</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>() +
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="no">n</span>, <span class="no">ts</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">id</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu">facet_wrap</span>(~<span class="no">dtwclust_ts</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Sayood, K. (2006). <em>Introduction to data compression</em>.</p>
<p>Primer on DCT: <a href="https://squidarth.com/rc/math/2018/06/24/fourier.html" class="uri">https://squidarth.com/rc/math/2018/06/24/fourier.html</a></p>
<p>dtwclust and dtt</p>
<p>This package is modeled after the <a href="https://github.com/tidymodels/textrecipes">textrecipes</a>: both packages transform a sequence of data (words vs. time series).</p>
<p>The <a href="https://feasts.tidyverts.org/">feasts</a> R package and the Python package <a href="https://github.com/blue-yonder/tsfresh">tsfresh</a> contain many other time series preprocessing methods not included in this package.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/tmastny/tsrecipes/">https://​github.com/​tmastny/​tsrecipes/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/tmastny/tsrecipes/issues">https://​github.com/​tmastny/​tsrecipes/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Timothy Mastny <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Timothy Mastny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
